<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width">
		<title>TFDG - Privacy</title>
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
		<link rel="icon" href="favicon.png" sizes="16x16">
		<link rel="icon" href="favicon-32.png" sizes="32x32">
		<link rel="icon" href="favicon-152.png" sizes="152x152">
		<link rel="icon" href="favicon-167.png" sizes="167x167">
		<link rel="icon" href="favicon-180.png" sizes="180x180">
		<link rel="icon" href="favicon-192.png" sizes="192x192">
		<link rel="icon" href="favicon-196.png" sizes="196x196">
		<script src="js/jquery-3.5.1.min.js"></script>
		<script src="js/bootstrap.bundle.min.js"></script>
	</head>
	<body>

	<script>

var myname="(none)";
var myuuid="(none)";
var sounds_enabled="(none)"
var dark="(none)"
var confirmcookie = ""

function confirmClearCookie(name){
	confirmcookie = name;
	$('#confirmmodal').modal();
}


function clearCookie(name){
	if(name != ""){
		document.cookie = name+"=;max-age=0;path=/;SameSite=Strict;Secure";
		$("#cv-"+name).text("(none)");
	}
}

function getCookies(){
	document.cookie.split(";").forEach(function(cookie){
		var parts = cookie.split("=");
		console.log(cookie);
		switch(parts[0].trim().toLowerCase()){
			case "name":
				myname = decodeURIComponent(parts[1]);
				break;
			case "uuid":
				myuuid = parts[1];
				break;
			case "sounds":
				sounds_enabled = parts[1];
				break;
			case "dark":
				dark = parts[1];
				break;
		}
	});
}

function displayCookies(){
	getCookies();
	$("#cv-name").text(myname);
	$("#cv-uuid").text(myuuid);
	$("#cv-sounds").text(sounds_enabled);
	$("#cv-dark").text(dark);
}

$(document).ready(function(){
	displayCookies()
});

	</script>
		<div class="modal fade" id="confirmmodal" tabindex="-1" role="dialog">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Confirm cookie removal</h5>
					</div>
					<div class="modal-body">
						<p>If you are already playing a game, clearing this cookie will make it impossible for you to rejoin that game.</p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary" data-dismiss="modal">Leave cookie untouched</button>
						<button type="button" class="btn btn-danger" data-dismiss="modal" onclick="clearCookie(confirmcookie);">Clear</button>
					</div>
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="col">
					<h1 class="display-2 mb-3">Fibbing Dice - Privacy</h1>
					<h2>Cookies</h2>
					<p class="lead mb-4">The following cookies are stored by Fibbing Dice:</p>

					<div class="container table-responsive" style="max-width:576px">
						<table class="table table-sm">
							<tr><th>Cookie name</th><th>Purpose</th><th>Value</th><th></th></tr>
							<tr><td>name</td><td>Display name</td><td id="cv-name">?</td><td><button type="button" class="btn-sm btn-primary" onclick="confirmClearCookie('name');">Clear</button></td></tr>
							<tr><td>uuid</td><td>Unique ID, to allow rejoining mid game</td><td id="cv-uuid">?</td><td><button type="button" class="btn-sm btn-primary" onclick="confirmClearCookie('uuid');">Clear</button></td></tr>
							<tr><td>sounds</td><td>Sound effect preference</td><td id="cv-sounds">?</td><td><button type="button" class="btn-sm btn-primary" onclick="clearCookie('sounds');">Clear</button></td></tr>
							<tr><td>dark</td><td>Dark theme preference</td><td id="cv-dark">?</td><td><button type="button" class="btn-sm btn-primary" onclick="clearCookie('dark');">Clear</button></td></tr>
						</table>
					</div>

					<h2>Data on server</h2>
					<p class="lead mb-4">The game server stores the state of
					current games on disk. This includes the display name and
					unique player ID for all current players, as well as their
					dice, and other non-identifiable game state parameters.
					This information is stored for the duration of the game
					only.</p>

					<p class="lead mb-4">The game server collects and stores
					information on games that have been played. This
					information contains no personally identifiable data and
					consists of:</p>
					<ul>
						<li>The number of players at game start</li>
						<li>The maximum number of dice used</li>
						<li>The maximum dice value used</li>
						<li>The game result (game-over, expired, left lobby before start)</li>
						<li>The number of rounds played</li>
						<li>The number of dice held by the winner</li>
						<li>The number of successful dudo calls</li>
						<li>The number of unsuccessful dudo calls</li>
						<li>The number of successful calza calls</li>
						<li>The number of unsuccessful calza calls</li>
						<li>The game duration</li>
						<li>The total counts of each dice value</li>
					</ul>
				</div>
			</div>
		</div>
	</body>
</html>
