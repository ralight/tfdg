<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width">
		<title>TFDG</title>
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
		<link href="css/dice.css" rel="stylesheet" type="text/css">
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>

		<link rel="icon" href="img/favicon.png" sizes="16x16" id="icon16">
		<link rel="icon" href="img/favicon-32.png" sizes="32x32" id="icon32">
		<link rel="icon" href="img/favicon-152.png" sizes="152x152">
		<link rel="icon" href="img/favicon-167.png" sizes="167x167">
		<link rel="icon" href="img/favicon-180.png" sizes="180x180">
		<link rel="icon" href="img/favicon-192.png" sizes="192x192">
		<link rel="icon" href="img/favicon-196.png" sizes="196x196" id="icon196">
		<script src="js/jquery-3.5.1.min.js"></script>
		<script src="js/bootstrap.bundle.min.js"></script>
		<script src="js/paho-mqtt.js"></script>
		<script src="js/banner.js"></script>
	</head>
	<body>

	<script>

var mqtt = null;
var myname = "";
var myuuid = "";
var havelost = false;
var palifico = null;
var snd_roll = null;
var sounds = null;
var first_sound = true;
var name_uuid = {};
var room_uuid = "0001";
var have_state = false;
var player_results = [];
var dudo_candidates = [];
var calza_candidate = null;
const dice_styles = "star diceU dice1 dice2 dice3 dice4 dice5 dice6 dice7 dice8 dice9";
const number_plurals = ["Ones", "Twos", "Threes", "Fours", "Fives", "Sixes", "Sevens", "Eights", "Nines"];
const timeout_times = [0, 100, 200, 500, 1000, 2000, 3000];
var summary_results = null;
const snd_player = new Audio("sound/silence.mp3");
var options = {
	"allow-calza": true,
	"max-dice": 5,
	"max-dice-value": 6,
	"roll-dice-at-start": true,
	"sounds-enabled": true,
	"results-timeout-value": 1000
};
var preRollRound = 1;

var topic_prefix = "tfdg/"+room_uuid+"/";
var palifico_round = false;
var dice_count = options['max-dice'];
var player_to_remove = null;
var game_playing = false;
var host = "";
var starter = null;

function uuidv4() {
	return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
		(c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16));
}

const entityMap = {
	';': '&semi;',
	'&': '&amp;',
	'<': '&lt;',
	'>': '&gt;',
	'"': '&quot;',
	"'": '&#39;',
	'/': '&#x2F;',
	'=': '&#x3D;'
};

const entityRevMap = {
	'&semi;': ';',
	'&amp;': '&',
	'&lt;': '<',
	'&gt;': '>',
	'&quot;': '"',
	'&#39;': "'",
	'&#x2F;': '/',
	'&#x3D;': '='
};

function escapeHtml(string) {
	return String(string).replace(/[;&<>"'\/=]/g, function (s) {
		return entityMap[s];
	});
}

function unescapeHtml(string){
	Object.keys(entityRevMap).forEach(function (key){
		string = string.replace(key, entityRevMap[key]);
	});
	return string;
}

function easy_publish(topic)
{
	mqtt.publish(topic_prefix+topic, JSON.stringify(name_uuid));
}


function kickPlayerConfirm(name, uuid){
	if(host != myuuid) return;
	player_to_remove = {"name":unescapeHtml(name), "uuid":unescapeHtml(uuid)};

	$('#kickmodal').modal();
}

function kickPlayer(){
	if(player_to_remove == null) return;

	mqtt.publish(topic_prefix+"kick-player", JSON.stringify(player_to_remove));
	player_to_remove = null;
}

function enable_calza(enabled){
	if($("#gametable div div.card-body").length < 3 || palifico_round == true || dice_count == options['max-dice']){
		enabled = false;
	}else{
		if(options['allow-calza'] && enabled == true){
			enabled = true;
		}else{
			enabled = false;
		}
	}
	if(enabled){
		$("#b-calza").prop("disabled", false);
		$("#b-calza").removeClass("btn-outline-secondary");
		$("#b-calza").addClass("btn-warning");
	}else{
		$("#b-calza").prop("disabled", true);
		$("#b-calza").addClass("btn-outline-secondary");
		$("#b-calza").removeClass("btn-warning");
	}
}

function enable_dudo(enabled){
	if(enabled){
		$("#b-dudo").prop("disabled", false);
		$("#b-dudo").addClass("btn-primary");
		$("#b-dudo").removeClass("btn-outline-secondary");
	}else{
		$("#b-dudo").prop("disabled", true);
		$("#b-dudo").addClass("btn-outline-secondary");
		$("#b-dudo").removeClass("btn-primary");
	}
}

function enable_loser(enabled){
	if(enabled){
		$("#b-loser").prop("disabled", false);
		$("#b-loser").addClass("btn-danger");
		$("#b-loser").removeClass("btn-outline-secondary");
	}else{
		$("#b-loser").prop("disabled", true);
		$("#b-loser").addClass("btn-outline-secondary");
		$("#b-loser").removeClass("btn-danger");
	}
}

function enable_roll(enabled){
	if(enabled){
		$("#b-roll").prop("disabled", false);
		$("#b-roll").addClass("btn-success");
		$("#b-roll").removeClass("btn-outline-secondary");
	}else{
		$("#b-roll").prop("disabled", true);
		$("#b-roll").addClass("btn-outline-secondary");
		$("#b-roll").removeClass("btn-success");
	}
}

function enableStartGame()
{
	if(host == myuuid && $("#gametable div div.card-header").length >= 2){
		$("#b-start").addClass("btn-success");
		$("#b-start").removeClass("btn-outline-secondary");
		$("#b-start").prop("disabled", false);
	}else{
		$("#b-start").removeClass("btn-success");
		$("#b-start").addClass("btn-outline-secondary");
		$("#b-start").prop("disabled", true);
	}
}

function setLobby(data){
	clearCards();

	handleSetOption(data['options']);

	var players = data['players'];
	for(i=0; i<players.length; i++){
		addPlayerCard(players[i]);
	}
	$("#"+myuuid).addClass("border-info");
	$("#"+myuuid).css("border-width", "2px");
	enableStartGame();
}

function play_sound(snd)
{
	console.log(snd);
	if(options['sounds-enabled']){
		sounds[snd].src = "sound/"+snd+".mp3";
		sounds[snd].play();
	}
}


function addPlayerCard(data) {
	var name = escapeHtml(data['name']);
	var uuid = escapeHtml(data['uuid']);

	var ishost = "";
	if(uuid == host){
		ishost = "<img src='img/host.svg' width='20' height='20' class='mr-1'/>";
	}
	var card = '<div class="card text-center float-left m-1" id="'+uuid+'">'+
		'<div class="card-header" style="padding:0.5rem 1.25rem" onclick="kickPlayerConfirm(\''+name+'\',\''+uuid+'\');"><span>'+ishost+'</span>'+name+' ⇨</div>'+
			'<div class="card-body" style="padding:0.5rem">';
	for(var i=1; i<options['max-dice']+1; i++){
		card += '<div class="dice diceU" id="'+uuid+'-d'+i+'"></div>';
		if(i%5 == 0){
			card += "<br>";
		}
	}

	card += '</div></div>';


	$("#gametable").append(card);
}

function resetPlayerCardDice(){
	var uuid = "";
	$("#gametable div div.card-body").each(function(index){
		var uuid = $(this).find("div")[0].id.substr(0, 36);
		$(this).empty();
		var card = "";
		for(var i=1; i<options['max-dice']+1; i++){
			card += '<div class="dice diceU" id="'+uuid+'-d'+i+'"></div>';
			if(i%5 == 0){
				card += "<br>";
			}
		}
		$(this).append(card);
	});
}

function removePlayerCard(uuid) {
	$("#"+uuid).remove();
}


function clearCards(){
	$("#gametable").empty();
}

function setDiceUnknown(){
	$("#gametable div div.card-body div").empty()
	$("#gametable div div.card-body div").removeClass(dice_styles);
	$("#gametable div div.card-body div").addClass("diceU");
}

function setDiceStar(){
	$("#gametable div div.card-body div").each(function(){
		if($(this).hasClass("dice1")
				|| $(this).hasClass("dice2")
				|| $(this).hasClass("dice3")
				|| $(this).hasClass("dice4")
				|| $(this).hasClass("dice5")
				|| $(this).hasClass("dice6")
				|| $(this).hasClass("dice7")
				|| $(this).hasClass("dice8")
				|| $(this).hasClass("dice9")){

			$(this).empty()
			$(this).removeClass(dice_styles);
			$(this).addClass("star");
		}
	});

	$("div.card div.card-header").removeClass("bg-success bg-danger bg-warning");
	$("div.card").removeClass("border-success border-danger border-warning text-white");
	$("div.card div.card-header").addClass("bg-warning");
	$("div.card").addClass("border-warning");
}

function clearSummaryResults(){
	for(i=0; i<options['max-dice-value']; i++){
		$("#tot"+(i+1)).text("?");
	}
}

function preRollInit(data){
	$("#gamectrl").removeClass("d-none");
	$("#lobbyctrl1").addClass("d-none");
	$("#lobbyctrl2h").addClass("d-none");
	$("#lobbyctrl2p").addClass("d-none");
	$("#preroll-text").removeClass("d-none");
	while(data.length > 0){
		p = data.shift()
		var uuid = p['uuid'];
		if(uuid == myuuid){
			enable_roll(true);
		}
	}
	enable_dudo(false);
}

function preRoll(data){
	clearBGs();

	var uuid = data['uuid'];
	var v = data['value'];

	$("#"+uuid+"-d"+preRollRound).empty();
	$("#"+uuid+"-d"+preRollRound).removeClass(dice_styles);
	$("#"+uuid+"-d"+preRollRound).addClass("dice"+v);

	if(uuid == myuuid){
		enable_roll(false);
	}
	play_sound("roll1");
}

function preRollResults(data){
	if(data.length == 1){
		enable_roll(true);
	}
	while(data.length > 0){
		p = data.shift()
		var uuid = p['uuid'];
		$("#"+uuid+" div.card-header").addClass("bg-success");
		$("#"+uuid).addClass("border-success text-white");
		if(uuid == myuuid){
			enable_roll(true);
		}
	}
	preRollRound += 1;
}

function newRound(data){
	game_playing = true;
	$("#t-o-form").prop("disabled", true);
	$("#prefctrl").collapse('hide');
	console.log("new round");
	palifico_round = data['palifico-round'];
	if(palifico_round){
		$("#palifico-banner").removeClass("d-none");
		play_sound("palifico");
	}else{
		$("#palifico-banner").addClass("d-none");
	}
	setStarter(data['starter']);
	$("#b-undo-loser").addClass("d-none");
	$("#b-undo-winner").addClass("d-none");
	$("#b-loser").removeClass("d-none");
	$("#b-winner").addClass("d-none");
	$("#b-calza").removeClass("d-none");

	if(havelost == false){
		$("#b-snd1").prop("disabled", false);
		$("#b-snd2").prop("disabled", false);
		enable_dudo(false);
		enable_calza(false);
		enable_loser(false);
		enable_roll(true);
		$("#b-leave").prop("disabled", false);
	}else{
		$("#b-snd1").prop("disabled", false);
		$("#b-snd2").prop("disabled", false);
		enable_dudo(false);
		enable_calza(false);
		enable_loser(false);
		enable_roll(false);
		$("#b-leave").prop("disabled", false);
	}
	$("#gamectrl").removeClass("d-none");
	$("#lobbyctrl1").addClass("d-none");
	$("#lobbyctrl2h").addClass("d-none");
	$("#lobbyctrl2p").addClass("d-none");
	$("#preroll-text").addClass("d-none");
	setDiceUnknown();
	clearSummaryResults();
}

function setCookies(name, uuid){
	document.cookie = "name=" + encodeURIComponent(name) + ";max-age=86400;path=/;SameSite=Strict;Secure";
	document.cookie = "uuid=" + encodeURIComponent(uuid) + ";max-age=86400;path=/;SameSite=Strict;Secure";
}

function getCookies(){
	document.cookie.split(";").forEach(function(cookie){
		var parts = cookie.split("=");
		switch(parts[0].trim().toLowerCase()){
			case "name":
				myname = decodeURIComponent(parts[1]);
				break;
			case "uuid":
				myuuid = decodeURIComponent(parts[1]);
				break;
			case "sounds":
				if(parts[1] == "true"){
					options['sounds-enabled'] = true;
				}else if(parts[1] == "false"){
					options['sounds-enabled'] = false;
				}
				$("#t-sound").attr("checked", options['sounds-enabled']);
				break;
		}
	});
	name_uuid = {"name":myname, "uuid":myuuid};
}



function setStarter(data){
	clearBGs();
	starter = data;
	var uuid = data['uuid'];
	$("div.card div.card-header").removeClass("bg-success");
	$("#"+uuid+" div.card-header").addClass("bg-success");
	$("div.card").removeClass("border-success text-white");
	$("#"+uuid).addClass("border-success text-white");
}

function callCalza(){
	easy_publish("call-calza");
}

function clearBGs(){
	$("div.card div.card-header").removeClass("bg-success bg-danger bg-warning");
	$("div.card").removeClass("border-success border-danger border-warning text-white");
	$("#"+myuuid).addClass("border-info");
	$("#"+myuuid).css("border-width", "2px");
}

function setDudo(data){
	clearBGs();

	enable_roll(false);
	$("#b-snd1").prop('disabled', true);
	$("#b-snd2").prop('disabled', true);
	enable_dudo(false);
	enable_calza(false);
	$("#b-leave").prop("disabled", true);
	dudo_candidates = data;
	calza_candidate = null;
}


function setCalza(data){
	clearBGs();

	enable_roll(false);
	$("#b-snd1").prop('disabled', true);
	$("#b-snd2").prop('disabled', true);
	enable_dudo(false);
	enable_calza(false);
	$("#b-leave").prop("disabled", true);
	calza_candidate = data;
	dudo_candidates = [];
}


function showSummary(heading)
{
	if(summary_results == null) return;

	for(i=0; i<summary_results['totals'].length; i++){
		$("#tot"+(i+1)).text(summary_results['totals'][i]);
	}
	$("#results-header").text(heading);
	summary_results = null;
}

function allowLosers(){
	if(dudo_candidates.length == 2){
		var player1 = dudo_candidates[0];
		var player2 = dudo_candidates[1];
		var uuid1 = player1['uuid'];
		var uuid2 = player2['uuid'];
		$("#"+uuid1+" div.card-header").addClass("bg-danger");
		$("#"+uuid1).addClass("border-danger text-white");
		$("#"+uuid2+" div.card-header").addClass("bg-danger");
		$("#"+uuid2).addClass("border-danger text-white");
		if((uuid1 == myuuid || uuid2 == myuuid) && havelost == false){
			enable_loser(true);
		}
	}else if(calza_candidate != null){
		var player1 = calza_candidate;
		var uuid1 = player1['uuid'];
		$("#"+uuid1+" div.card-header").addClass("bg-danger");
		$("#"+uuid1).addClass("border-danger text-white");
		if(uuid1 == myuuid && havelost == false){
			$("#b-calza").addClass("d-none");
			$("#b-winner").removeClass("d-none");
			enable_calza(true);
			enable_loser(true);
			$("#b-winner").prop('disabled', false);
		}
	}
}


function showPlayerDiceQuick(){
	clearBGs();
	while(player_results.length > 0){
		p = player_results.shift()
		var uuid = p['uuid'];
		var j;

		p['dice'].sort();
		for(j=0;j<p['dice'].length;j++){
			v = p['dice'][j];
			$("#"+uuid+"-d"+(j+1)).empty();
			$("#"+uuid+"-d"+(j+1)).removeClass(dice_styles);
			if(v != " "){
				$("#"+uuid+"-d"+(j+1)).addClass("dice"+v);
			}
		}
		for(;j<options['max-dice'];j++){
			$("#"+uuid+"-d"+(j+1)).empty();
			$("#"+uuid+"-d"+(j+1)).removeClass(dice_styles);
		}
	}
}

function showPlayerDice(){
	clearBGs();
	if(player_results.length > 0){
		p = player_results.shift()
		var uuid = p['uuid'];

		$("#"+uuid+" div.card-header").addClass("bg-warning");
		p['dice'].sort();
		var j;
		for(j=0;j<p['dice'].length;j++){
			v = p['dice'][j];
			$("#"+uuid+"-d"+(j+1)).empty();
			$("#"+uuid+"-d"+(j+1)).removeClass(dice_styles);
			if(v != " "){
				$("#"+uuid+"-d"+(j+1)).addClass("dice"+v);
			}
		}
		for(;j<options['max-dice'];j++){
			$("#"+uuid+"-d"+(j+1)).empty();
			$("#"+uuid+"-d"+(j+1)).removeClass(dice_styles);
		}
		setTimeout(showPlayerDice, options['results-timeout-value']);
	}else{
		showSummary("Dice");
		setTimeout(allowLosers, options['results-timeout-value']);
	}
}

function showMyDice(data){
	var i;
	data.sort();
	for(i=0; i<data.length; i++){
		v = data[i];
		var uuid = myuuid;
		$("#"+uuid+"-d"+(i+1)).empty();
		$("#"+uuid+"-d"+(i+1)).removeClass(dice_styles);
		if(v != " "){
			$("#"+uuid+"-d"+(i+1)).addClass("dice"+v);
		}
	}
	for(;i<options['max-dice'];i++){
		$("#"+uuid+"-d"+(i+1)).empty();
		$("#"+uuid+"-d"+(i+1)).removeClass(dice_styles);
	}
	dice_count = data.length;
	enable_calza(true);
}


function handleRoundLoser(data){
	var uuid = data["uuid"];
	$("#"+uuid+"-d1").empty();
	$("#"+uuid+"-d1").append('<img src="img/diceX.svg" width="20" height="20"/>');

	if(havelost == false){
		enable_roll(true);
		if(uuid == myuuid){
			$("#b-undo-loser").removeClass("d-none");
			$("#b-loser").addClass("d-none");
		}else{
			$("#b-undo-loser").addClass("d-none");
			enable_loser(false);
			$("#b-loser").removeClass("d-none");
		}
	}
	$("#b-winner").prop('disabled', true);
	$("#b-leave").prop("disabled", false);
}


function handleRoundWinner(data){
	var uuid = data["uuid"];
	/*$("#"+uuid+"-d"+options['max-dice']).empty();*/
	/*$("#"+uuid+"-d"+options['max-dice']).addClass("diceU");*/

	enable_roll(true);
	enable_loser(false);
	if(uuid == myuuid){
		$("#b-undo-winner").removeClass("d-none");
		$("#b-winner").addClass("d-none");
	}else{
		$("#b-undo-winner").addClass("d-none");
		$("#b-winner").addClass("d-none");
	}
	$("#b-leave").prop("disabled", false);
}


function handlePlayerLeft(data){
	if(data['uuid'] == myuuid){
		havelost = true;
		enable_roll(false);
		$("#b-snd1").prop("disabled", true);
		$("#b-snd2").prop("disabled", true);
		enable_dudo(false);
		enable_calza(false);
		enable_loser(false);
		$("#b-leave").prop("disabled", true);
	}
	removePlayerCard(data['uuid']);
}


function playerLost(data){
	if(data['uuid'] == myuuid){
		havelost = true;
		enable_roll(false);
		$("#b-snd1").prop("disabled", true);
		$("#b-snd2").prop("disabled", true);
		enable_dudo(false);
		enable_calza(false);
		enable_loser(false);
		document.getElementById("icon16").href = "/img/dice-32-X.png";
		document.getElementById("icon32").href = "/img/dice-32-X.png";
		document.getElementById("icon196").href = "/img/dice-32-X.png";
	}
	removePlayerCard(data['uuid']);
	console.log(data['name'] + " has lost");

	if(havelost == false){
		enable_loser(false);
		enable_roll(true);
	}
}

function onConnectionLost(responseObject) {
  if (responseObject.errorCode !== 0) {
    console.log("onConnectionLost:"+responseObject.errorMessage);
  }
}

function handleState(data){
	console.log(data);
	setLobby(data);

	game_playing = true;

	$("#lobbyctrl2h").addClass("d-none");
	$("#lobbyctrl2p").addClass("d-none");
	$("#preroll-text").addClass("d-none");

	if(data['options']){
		handleSetOption(data['options']);
	}

	if(data['palifico-round']){
		palifico_round = true;
		$("#palifico-banner").removeClass("d-none");
	}else{
		palifico_round = false;
		$("#palifico-banner").addClass("d-none");
	}
	if(data['starter']){
		$("#gamectrl").removeClass("d-none");
		$("#lobbyctrl1").addClass("d-none");

		setStarter(data['starter']);
	}


	/* Dice must be shown after options, in case of options changing meaning
	  dice are added/removed */
	if(data['dice']){
		showMyDice(data['dice']);
		enable_roll(false);
		enable_dudo(true);
		$("#b-snd1").prop("disabled", false);
		$("#b-snd2").prop("disabled", false);
	}
	if(data['results']){
		$("#gamectrl").removeClass("d-none");
		$("#preroll-text").addClass("d-none");

		player_results = data['results'];
		showPlayerDiceQuick();
		enable_roll(false);
		enable_dudo(false);
		$("#b-snd1").prop("disabled", true);
		$("#b-snd2").prop("disabled", true);
	}
	/* Dudo/calza/loser must be after results are shown */
	if(data['dudo-candidates']){
		setDudo(data['dudo-candidates']);
		allowLosers();
	}else if(data['calza-candidate']){
		setCalza(data['calza-candidate']);
		allowLosers();
	}else{
		enable_loser(false);
	}
	if(data['round-loser']){
		handleRoundLoser(data['round-loser']);
	}
	if(data['round-winner']){
		handleRoundWinner(data['round-winner']);
	}
}


function showNewGame(){
	$("#gamectrl").addClass("d-none");
	$("#restartctrl").removeClass("d-none");
	mqtt.disconnect();
}

function handleUndoLoser(data){
	$("#gametable div div.card-body div").empty()
	$("#b-loser").removeClass("d-none");
	$("#b-undo-loser").addClass("d-none");
	if(Array.isArray(data)){
		setDudo(data);
	}else{
		setCalza(data);
	}
	allowLosers();
}

function handleUndoWinner(data){
	var uuid = data["uuid"];
	$("#gametable div div.card-body div").empty()

	if(uuid == myuuid){
		$("#b-winner").removeClass("d-none");
		$("#b-undo-winner").addClass("d-none");
	}
	setCalza(data);
	allowLosers();
}

function handleLoserResults(data)
{
	console.log(data);
	player_results = data;
	showPlayerDiceQuick();
	setStarter(starter);
}

function handleSoundHigher(data)
{
	console.log(data);
	var num = data['sound'] % 7 + 1;
	if(num < 0){
		return;
	}

	play_sound("higher"+num);
}

function handleSoundExact(data)
{
	console.log(data);
	var num = data['sound'] % 6 + 1;
	if(num < 0){
		return;
	}

	play_sound("exact"+num);
}

function handleHost(data){
	host = data["uuid"];
	if(host == myuuid){
		$("#t-o-form").prop("disabled", game_playing);
	}else{
		$("#t-o-form").prop("disabled", true);
	}
	if(game_playing == false){
		if(host == myuuid){
			$("#lobbyctrl2h").removeClass("d-none");
			$("#lobbyctrl2p").addClass("d-none");
		}else{
			$("#lobbyctrl2h").addClass("d-none");
			$("#lobbyctrl2p").removeClass("d-none");
		}
	}

	enableStartGame();

	if(host != ""){
		$("#gametable div div.card-header span").empty();
		$("#"+host+" div span").append("<img src='img/host.svg' width='20' height='20' class='mr-1'/>");
	}
}

function handleSetOption(data){
	console.log(data);
	if("allow-calza" in data){
		options['allow-calza'] = data['allow-calza'];
		$("#t-o-allow-calza").prop("checked", options['allow-calza']);
	}
	if("losers-see-dice" in data){
		$("#t-o-losers-see-dice").prop("checked", data['losers-see-dice']);
	}
	if("roll-dice-at-start" in data){
		$("#t-o-roll-dice-at-start").prop("checked", data['roll-dice-at-start']);
	}
	if("show-results-table" in data){
		if(data['show-results-table']){
			$("#summary-results").removeClass("d-none");
			$("#t-o-show-results-table").prop("checked", true);
		}else{
			$("#summary-results").addClass("d-none");
			$("#t-o-show-results-table").prop("checked", false);
		}
	}
	if("max-dice" in data){
		options['max-dice'] = data['max-dice'];
		resetPlayerCardDice();
		$("#l-max-dice-range").text(options['max-dice']);
		$("#max-dice-range").val(options['max-dice']);
	}
	if("max-dice-value" in data){
		options['max-dice-value'] = data['max-dice-value'];
		$("#l-max-dice-value-range").text(options['max-dice-value']);
		$("#max-dice-value-range").val(options['max-dice-value']);

		$("#summary-results-table").empty();
		var tab = "<tr><th></th><th id=\"results-header\">Dice</th></tr>";
		for(var i=0; i<options['max-dice-value']; i++){
			tab += '<tr><td>'+number_plurals[i]+'<td id="tot'+(i+1)+'">?</td></tr>';
		}
		$("#summary-results-table").append(tab);
	}
}

function startMQTT(){
	console.log("Start");
	var clientId = "";
	var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
	for (var i = 0; i < 20; i++){
		clientId += chars.charAt(Math.floor(Math.random() * chars.length));
	}
	var lwt = new Paho.Message(JSON.stringify(name_uuid));
	lwt.destinationName = topic_prefix+"logout";
	lwt.qos = 1;
	lwt.retained = false;

	mqtt = new Paho.Client("wss://tfdg.ral.me/mqtt", clientId);
	mqtt.onConnectionLost = onConnectionLost;
	mqtt.connect({
		onSuccess: function (){
			console.log("Connected to MQTT");
			mqtt.subscribe("tfdg/#");
			easy_publish("login");
		}, cleanSession:true, useSSL:true, keepAliveInterval: 30, reconnect: true,
		 willMessage: lwt
	});
	mqtt.onMessageArrived = function(message){
		console.log(message.destinationName);
		if(message.destinationName.startsWith(topic_prefix) == false){
			return;
		}
		var cmd = message.destinationName.substr(topic_prefix.length);
		var data = null;
		if(message.payloadString.length > 0){
			data = JSON.parse(message.payloadString);
		}

		if(cmd == "summary-results"){
			console.log("Received result summary");
			summary_results = data;
		}else if(cmd == "lobby-players"){
			setLobby(data);
			have_state = true;
		}else if(cmd == "state"){
			if(have_state == false){
				console.log(message.payloadString);
				handleState(data);
				have_state = true;
			}
		}else if(cmd == "player-results"){
			player_results = data;
			console.log(player_results);
			setTimeout(showPlayerDice, options['results-timeout-value']);
		}else if(cmd == "pre-roll-init"){
			preRollInit(data);
		}else if(cmd == "pre-roll"){
			preRoll(data);
		}else if(cmd == "pre-roll-results"){
			preRollResults(data);
		}else if(cmd == "new-round"){
			newRound(data);
		}else if(cmd == "dudo-candidates"){
			setDudo(data);
		}else if(cmd == "calza-candidate"){
			setCalza(data);
		}else if(cmd == "dice/"+myuuid){
			console.log("Received my dice: "+message.payloadString);
			showMyDice(data);
			if(data.length > 0){
				if(data.length < 6){
					play_sound("roll"+data.length);
				}else{
					play_sound("roll5");
				}
				if(data.length < 10){
					document.getElementById("icon16").href = "/img/dice-32-"+data.length+".png";
					document.getElementById("icon32").href = "/img/dice-32-"+data.length+".png";
					document.getElementById("icon196").href = "/img/dice-32-"+data.length+".png";
				}else{
					document.getElementById("icon16").href = "/img/dice-32-9.png";
					document.getElementById("icon32").href = "/img/dice-32-9.png";
					document.getElementById("icon196").href = "/img/dice-32-9.png";
				}
			}
			enable_roll(false);
			enable_dudo(true);
			$("#b-snd1").prop("disabled", false);
			$("#b-snd2").prop("disabled", false);
		}else if(cmd == "allow-losers"){
			allowLosers(data[0], data[1]);
		}else if(cmd == "round-loser"){
			console.log(message.payloadString + " lost a dice");
			handleRoundLoser(data);
		}else if(cmd == "game-loser"){
			console.log(message.payloadString + " lost the game");
			play_sound("game-loser");
		}else if(cmd == "round-winner"){
			console.log(message.payloadString + " won a dice");
			handleRoundWinner(data);
		}else if(cmd == "player-left"){
			console.log(message.payloadString + " left the game");
			handlePlayerLeft(data);
		}else if(cmd == "player-lost"){
			console.log(message.payloadString + " lost their last dice");
			playerLost(data);
		}else if(cmd == "winner"){
			summary_results = data;
			showSummary("Total Dice");
			setDiceStar();
			if(data['winner']['name'].length < 10){
				$("#banner").removeClass("d-none");
				let name = escapeHtml(data['winner']['name']);
				$("#bannertext").html(name + " is awesome!");
				animate();
			}
			play_sound("game-winner");
			setTimeout(showNewGame(), 1000);
		}else if(cmd == "room-closing"){
			showNewGame();
		}else if(cmd == "starter"){
			setStarter(data);
		}else if(cmd == "undo-loser"){
			handleUndoLoser(data);
		}else if(cmd == "undo-winner"){
			handleUndoWinner(data);
		}else if(cmd == "set-option"){
			handleSetOption(data);
		}else if(cmd == "host"){
			handleHost(data);
		}else if(cmd == "loser-results"){
			handleLoserResults(data);
		}else if(cmd == "snd-higher"){
			handleSoundHigher(data);
		}else if(cmd == "snd-exact"){
			handleSoundExact(data);
		}
	}
}

function startPlay(){
	getCookies();
	console.log("Start play: "+myname);
	if(myname == "" || myuuid == ""){
		$('#playermodal').modal({backdrop:false});
	}else{
		startMQTT();
	}
}

function saveName(){
	setCookies($("#nameinput").val(), uuidv4());
	$('#playermodal').modal('hide');
	startPlay();
}

function leaveGame(){
	$('#leavemodal').modal('hide');
	easy_publish("leave-game");
}

function handlePrefSound(val){
	options['sounds-enabled'] = val;
	if(options['sounds-enabled'] == true){
		document.cookie = "sounds=;max-age=0;path=/;SameSite=Strict;Secure";
	}else{
		document.cookie = "sounds="+options['sounds-enabled']+";max-age=2419200;path=/;SameSite=Strict;Secure";
	}
}

function handlePrefDark(){
	dark = $("#t-dark").is(":checked");
	if(dark == false){
		document.cookie = "dark=;max-age=0;path=/;SameSite=Strict;Secure";
		//document.body.style.backgroundColor = "white";
		//document.body.style.color = "#212529";
	}else{
		document.cookie = "dark="+dark+";max-age=2419200;path=/;SameSite=Strict;Secure";
		//document.body.style.backgroundColor = "#212529";
		//document.body.style.color = "white";
	}
}

function resetCopyClip()
{
	$("#copyclip").attr("src", "img/clipboard.svg");
}

function copyURL(){
	copyToClipboard("https://fibbingdice.com/?r="+room_uuid);
	$("#copyclip").attr("src", "img/clipboard-tick.svg");
	setTimeout(resetCopyClip, 1000);
}

function copyToClipboard(text) {
    if (window.clipboardData && window.clipboardData.setData) {
        // IE specific code path to prevent textarea being shown while dialog is visible.
        return clipboardData.setData("Text", text);

    } else if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
        var textarea = document.createElement("textarea");
        textarea.textContent = text;
        textarea.style.position = "fixed";  // Prevent scrolling to bottom of page in MS Edge.
        document.body.appendChild(textarea);
        textarea.select();
        try {
            return document.execCommand("copy");  // Security exception may be thrown by some browsers.
        } catch (ex) {
            console.warn("Copy to clipboard failed.", ex);
            return false;
        } finally {
            document.body.removeChild(textarea);
        }
    }
}

function setBoolOption(option, val){
	let data = {"name":myname, "uuid":myuuid, "option":option, "value":val};
	mqtt.publish(topic_prefix+"set-option", JSON.stringify(data));
}

function maxDiceValueRangeChange(val){
	$("#l-max-dice-value-range").text(val);
	let data = {"name":myname, "uuid":myuuid, "option":"max-dice-value", "value":parseInt(val)};
	mqtt.publish(topic_prefix+"set-option", JSON.stringify(data));
}

function maxDiceRangeChange(val){
	$("#l-max-dice-range").text(val);
	let data = {"name":myname, "uuid":myuuid, "option":"max-dice", "value":parseInt(val)};
	mqtt.publish(topic_prefix+"set-option", JSON.stringify(data));
}

function rollDice(){
	if(first_sound){
		/* Play sound in response to an onclick event to unlock sound on mobile */
		for (const [key, snd] of Object.entries(sounds)){
			snd.src = "sound/silence.mp3";
			snd.play();
		}
		first_sound = false;
	}
	easy_publish('roll-dice');
}

$(document).ready(function(){
	const uP = new URLSearchParams(window.location.search);
	room_uuid = uP.get("r");
	if(room_uuid == null || room_uuid == ""){
		$("#intro").removeClass("d-none");
		room_uuid = uuidv4();
		$("#room-link").attr("href", "https://fibbingdice.com/?r="+room_uuid);
		topic_prefix = "tfdg/"+room_uuid+"/";
	}else{
		topic_prefix = "tfdg/"+room_uuid+"/";
		$("#game").removeClass("d-none");
		$("#rules").addClass("d-none");
		startPlay();
	}
	if(room_uuid.substr(0, 8) == "fafffaff"){
		$("#b-snd1").removeClass("d-none");
		$("#b-snd2").removeClass("d-none");
	}

	if(uP.get("fast") == "1"){
		options['results-timeout-value'] = 0;
	}else{
		options['results-timeout-value'] = 1000;
	}

	$("#nameinput").keypress(function(e){
		if(e.which == 13){
			e.preventDefault()
			saveName();
		}
	});
});
$(window).on("load", function(){
	sounds = {
		"palifico" : new Audio("sound/palifico.mp3"),
		"dudo": new Audio("sound/dudo.mp3"),
		"roll1" : new Audio("sound/roll1.mp3"),
		"roll2" : new Audio("sound/roll2.mp3"),
		"roll3" : new Audio("sound/roll3.mp3"),
		"roll4" : new Audio("sound/roll4.mp3"),
		"roll5" : new Audio("sound/roll5.mp3"),
		"higher1" : new Audio("sound/higher1.mp3"),
		"higher2" : new Audio("sound/higher2.mp3"),
		"higher3" : new Audio("sound/higher3.mp3"),
		"higher4" : new Audio("sound/higher4.mp3"),
		"higher5" : new Audio("sound/higher5.mp3"),
		"higher6" : new Audio("sound/higher6.mp3"),
		"higher7" : new Audio("sound/higher7.mp3"),
		"exact1" : new Audio("sound/exact1.mp3"),
		"exact2" : new Audio("sound/exact2.mp3"),
		"exact3" : new Audio("sound/exact3.mp3"),
		"exact4" : new Audio("sound/exact4.mp3"),
		"exact5" : new Audio("sound/exact5.mp3"),
		"exact6" : new Audio("sound/exact6.mp3"),
		"game-loser" : new Audio("sound/game-loser.mp3"),
		"game-winner" : new Audio("sound/game-winner.mp3"),
	};
	first_sound = true;
});

	</script>
		<div class="modal fade" id="playermodal" tabindex="-1" role="dialog">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Enter name</h5>
					</div>
					<div class="modal-body">
						<p>This will store a cookie for your name, and a unique
						identifier which will both be used on the server for the
						duration of any games you play. <a href="privacy.html" target="_blank">Privacy</a>.</p>
						<input type="text" class="form-control" maxlength="30" placeholder="Name" id="nameinput">
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary" onclick="saveName();">Save</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="kickmodal" tabindex="-1" role="dialog">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Remove player</h5>
					</div>
					<div class="modal-body">
						<p>This will remove player from the game and they will be unable to rejoin. Only the host is able to remove players.</p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary" data-dismiss="modal">Return to game</button>
						<button type="button" class="btn btn-danger" data-dismiss="modal" onclick="kickPlayer();">Remove player</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="leavemodal" tabindex="-1" role="dialog">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Leave the game</h5>
					</div>
					<div class="modal-body">
						<p>This will forfeit the current game, and you will be unable to rejoin.</p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary" data-dismiss="modal">Carry on playing</button>
						<button type="button" class="btn btn-danger" onclick="leaveGame();">Leave</button>
					</div>
				</div>
			</div>
		</div>
		<div class="container d-none" id="game">
			<div class="row">
				<div class="col-1 ml-3 mt-1"></div>
				<div class="col-1 ml-3 mt-1"></div>
				<div class="col mt-1">
					<h2 class="text-center">Fibbing Dice</h2>
				</div>
				<div class="col-1 mt-2">
					<a href="/" target="_blank"><img src="img/q.svg" height="30"/></a>
				</div>
				<div class="col-1 mr-3 mt-2">
					<a data-toggle="collapse" href="#prefctrl"><img src="img/cog.svg" height="30"/></a>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="collapse" id="prefctrl">
						<hr style="margin-top:0.25rem; margin-bottom:0.25rem"/>
						<div class="row justify-content-center">
							<div class="col-sm-auto text-center">
								<button type="button" class="btn btn-danger m-1" id="b-leave" onclick="$('#leavemodal').modal();">Leave game</button>
								<h2 class="m-1">User preferences</h2>
								<p class="text-left">Changing these values will set cookies. <a href="privacy.html" target="_blank">Privacy</a>.</p>
								<div class="custom-control custom-switch text-left">
									<input type="checkbox" class="custom-control-input" id="t-sounds" checked onclick="handlePrefSound(this.checked);">
									<label class="custom-control-label" for="t-sounds">Allow sound effects</label>
								</div>
								<!--
								<div class="custom-control custom-switch">
									<input type="checkbox" class="custom-control-input" id="t-dark" onclick="handlePrefDark();">
									<label class="custom-control-label" for="t-dark">Dark theme</label>
								</div>
								-->
							</div>
						</div>
						<div class="row justify-content-center">
							<div class="col-sm-auto text-center">
								<h2 class="m-1">Table options</h2>
								<p class="text-left">Changing these values will set cookies. <a href="privacy.html" target="_blank">Privacy</a>.</p>
								<fieldset id="t-o-form">
								<div class="custom-control custom-switch text-left">
									<input type="checkbox" class="custom-control-input" id="t-o-allow-calza" checked onclick="setBoolOption('allow-calza', this.checked);">
									<label class="custom-control-label" for="t-o-allow-calza">Allow Calza</label>
								</div>
								<div class="custom-control custom-switch text-left">
									<input type="checkbox" class="custom-control-input" id="t-o-losers-see-dice" checked onclick="setBoolOption('losers-see-dice', this.checked);">
									<label class="custom-control-label" for="t-o-losers-see-dice">Losers see dice</label>
								</div>
								<div class="custom-control custom-switch text-left">
									<input type="checkbox" class="custom-control-input" id="t-o-show-results-table" checked onclick="setBoolOption('show-results-table', this.checked);">
									<label class="custom-control-label" for="t-o-show-results-table">Show results table</label>
								</div>
								<div class="custom-control custom-switch text-left">
									<input type="checkbox" class="custom-control-input" id="t-o-roll-dice-at-start" checked onclick="setBoolOption('roll-dice-at-start', this.checked);">
									<label class="custom-control-label" for="t-o-roll-dice-at-start">Roll dice to pick starter</label>
								</div>
								<div class="custom-control custom-switch text-left">
									<input type="checkbox" class="custom-control-input" id="t-o-random-max-dice-value" onclick="setBoolOption('random-max-dice-value', this.checked);">
									<label class="custom-control-label" for="t-o-random-max-dice-value">Random max dice value per round</label>
								</div>
								<div class="form-group text-left mt-1">
									Maximum dice count:
									<label for="max-dice-range" id="l-max-dice-range">5</label>
									<input type="range" class="form-control-range" id="max-dice-range" value="5" min="3" max="20" oninput="maxDiceRangeChange(this.value);"/>
								</div>
								<div class="form-group text-left mt-1">
									Maximum dice value:
									<label for="max-dice-value-range" id="l-max-dice-value-range">6</label>
									<input type="range" class="form-control-range" id="max-dice-value-range" value="6" min="3" max="9" oninput="maxDiceValueRangeChange(this.value);"/>
								</div>
								</fieldset>
							</div>
						</div>
						<hr style="margin-top:0.25rem; margin-bottom:0.25rem"/>
					</div>
					<div class="row justify-content-center d-none" id="gamectrl">
						<button type="button" class="d-none btn btn-light m-1 text-white" disabled id="b-snd1" onclick="easy_publish('snd-higher');">S</button>
						<button type="button" class="btn btn-success m-1" id="b-roll" onclick="rollDice();">Roll</button>
						<button type="button" class="btn btn-outline-secondary m-1" disabled id="b-dudo" onclick="easy_publish('call-dudo');" >Dudo</button>
						<button type="button" class="btn btn-outline-secondary m-1" disabled id="b-calza" onclick="easy_publish('call-calza');">Calza</button>
						<button type="button" class="btn btn-warning m-1 d-none" id="b-winner" onclick="easy_publish('i-won');">Winner</button>
						<button type="button" class="btn btn-warning m-1 d-none" id="b-undo-winner" onclick="easy_publish('undo-winner');">Undo</button>
						<button type="button" class="btn btn-outline-secondary m-1" disabled id="b-loser" onclick="easy_publish('i-lost');">Loser</button>
						<button type="button" class="btn btn-danger m-1 d-none" id="b-undo-loser" onclick="easy_publish('undo-loser');">Undo</button>
						<button type="button" class="d-none btn btn-light m-1 text-white" disabled id="b-snd2" onclick="easy_publish('snd-exact');">S</button>
					</div>
					<div class="row justify-content-center" id="lobbyctrl1">
						<button type="button" class="btn btn-outline-secondary m-1" disabled id="b-start" onclick="$('#prefctrl').collapse('hide');easy_publish('start-game');">Start Game</button>
					</div>
					<div class="row justify-content-center m-1 d-none" id="lobbyctrl2h">
						<p>Use the cog menu to configure the game settings. Once everybody has arrived, start the game.</p>
					</div>
					<div class="row justify-content-center m-1 d-none" id="lobbyctrl2p">
						<p>Wait for the host <img src='img/host.svg' width='20' height='20'/> to start the game.</p>
					</div>
					<div class="row justify-content-center m-1 d-none" id="preroll-text">
						<p>Roll your dice to decide who starts, highest wins.</p>
					</div>
					<div class="row justify-content-center d-none" id="restartctrl">
						<button type="button" class="btn btn-success m-1" id="b-newgame" onclick="location.reload();">New game</button>
					</div>
				</div>
			</div>

			<hr style="margin-top:0.25rem; margin-bottom:1rem"/>
		</div>
		<div class="container">
			<div class="alert alert-info d-none text-center" role="alert" id="palifico-banner">Palifico round!</div>
			<div class="row justify-content-center" id="gametable">
			</div>
			<hr style="margin-top:1rem; margin-bottom:0.25rem"/>
		</div>

		<div class="container d-none" id="banner" style="height:65px; width:100%;">
			<svg id="bannerimg" viewBox="0 0 1 1">
				<g id="all">
					<path class="flag-top" />

					<path class="flag-middle" id="MyPath" />
					<path class="flag-bottom" />
					<text text-anchor="middle">
						<textPath startOffset="50%" id="bannertext" href="#MyPath">Roger is awesome!</textPath>
					</text>
					<path class="flag-side-r" />
					<path class="flag-side-l" />
					<path class="tow-top" />
					<path class="tow-bottom" />
					<g id="g833">
						<path
				       d="m 24.16,48.5 c 1.64,-1.64 1.95,-5.2 0.63,-7.02 -0.59,-0.8 -0.65,-1.53 -0.24,-2.71 0.64,-1.85 -0.26,-1.68 16.47,-3.14 15.6,-1.36 17.5,-1.66 32.34,-5.24 15.55,-3.75 15.21,-3.72 16.07,-1.44 0.77,2.05 3.09,2.51 3.09,0.62 0,-0.62 -0.26,-1.29 -0.58,-1.49 -1.19,-0.74 -0.52,-1.4 1.89,-1.88 l 2.47,-0.49 2.45,-6.39 c 1.35,-3.52 2.46,-6.59 2.47,-6.83 0.01,-0.24 -2.94,-0.44 -6.56,-0.44 h -6.58 l -2.83,3.86 -2.83,3.86 -3.54,-0.32 C 76.93,19.28 71.5,18.81 66.81,18.41 l -8.53,-0.73 -1.79,1.5 c -3.4,2.86 -8.58,2.78 -11.76,-0.19 -1.36,-1.27 -2.38,-1.7 -4.08,-1.7 -1.25,0 -2.27,-0.26 -2.27,-0.58 0,-0.32 1.31,-0.58 2.91,-0.58 3.99,0 3.84,-0.54 -2.12,-8.13 C 33.47,0.73 35.24,1.5 21.75,0.34 10.28,-0.64 9.55,0.13 15.12,7.35 c 4.48,5.8 4.91,8.75 1.31,8.85 l -6.58,-0.71 6.54,1.34 2.14,0.57 0.19,4.62 0.19,4.62 -1.89,0 c -2.5,0 -2.45,1.14 0.15,3.42 1.61,1.41 2.04,2.23 2.04,3.85 v 2.06 l -4.22,0 C 12.65,35.93 10.43,35.72 10.04,35.47 8.22,34.32 7.54,23.1 9,18.29 L 9.85,15.49 7.4,15.66 C 5.17,15.83 4.87,16.03 4.24,17.88 3.6,19.77 3.55,19.54 3.52,14.8 3.49,10.75 3.3,9.61 2.59,9.34 1.06,8.75 0.87,9.59 0.83,17.04 c -0.02,3.97 -0.22,7.4 -0.44,7.62 -0.59,0.59 -0.49,3.12 0.13,3.12 0.3,0 0.39,2.47 0.21,5.75 -0.39,7.02 0.08,10.14 1.48,9.87 0.83,-0.16 1.01,-1.07 1.17,-5.72 0.17,-5.23 0.22,-5.43 0.97,-3.69 0.9,2.11 1.51,2.29 9.47,2.86 6.12,0.44 6.73,1.09 3.5,3.78 -1.57,1.32 -1.88,1.97 -1.88,4.04 0,4.68 5.48,7.08 8.73,3.83 z m -4.64,-2 c -0.18,-0.29 0.32,-0.94 1.1,-1.46 1.73,-1.14 2.05,-1.16 2.05,-0.18 0,1.61 -2.41,2.85 -3.16,1.64 z m -1.5,-1.56 c 0,-1.03 1.35,-2.58 2.25,-2.58 1.8,0 1.89,0.73 0.22,1.8 -1.68,1.08 -2.47,1.33 -2.47,0.78 z m 4.58,-3.02 c -0.72,-0.92 -0.7,-0.94 0.22,-0.22 0.56,0.44 1.02,0.9 1.02,1.02 0,0.48 -0.48,0.17 -1.24,-0.8 z m -0.91,-4.33 c 0.19,-0.46 0.32,-0.33 0.35,0.35 0.03,0.61 -0.11,0.96 -0.31,0.76 -0.19,-0.19 -0.21,-0.7 -0.05,-1.12 z m 4.9,-3.97 0.91,-2.33 h 5.11 c 2.81,0 5.26,-0.24 5.44,-0.52 0.48,-0.77 -2.67,-4.14 -3.88,-4.14 -0.9,0 -1.03,-0.57 -1.03,-4.37 v -4.37 h 4.07 c 3.29,0 4.07,0.17 4.07,0.9 0,7.17 14.58,8.54 18.04,1.7 1.01,-2 0.79,-1.99 14.84,-0.57 l 8.15,0.82 1.6,-1.73 1.6,-1.73 v 1.47 1.47 h 5.82 c 3.2,0 5.82,0.13 5.82,0.29 0,2.3 -2.2,4.96 -4.11,4.96 -1.15,0 -2.25,0.15 -2.44,0.34 -0.19,0.19 -1.6,0.42 -3.15,0.52 -1.54,0.09 -8.96,1.67 -16.48,3.5 -13.31,3.23 -31.65,5.87 -42.28,6.08 l -3.01,0.06 0.91,-2.33 z m -4.97,-0.75 c 0.12,-0.83 0.66,-1.36 1.49, -1.48 1.56,-0.22 1.57,-0.11 0.4,2.68 -0.99,2.37 -2.28,1.55 -1.89,-1.2 z M 4.72,30.07 C 3.73,25.3 4.7,17.55 6.21,18.13 c 0.47,0.18 1.07,0.33 1.33,0.33 0.26,0 0.22,1.11 -0.09,2.48 C 6.83,23.64 7.08,31.51 7.83,33.23 8.22,34.12 8.07,34.27 6.91,34.1 5.7,33.93 5.41,33.4 4.72,30.07 Z M 17.87,29.24 c -2.1,-2.89 15.28,-2.9 18.17,0 L 37.49,30.7 28.2,30.68 C 19.02,30.67 18.89,30.65 17.87,29.24 Z M 1.48,26.69 c -0.18,-0.28 0.05,-0.82 0.5,-1.19 0.91,-0.75 1.84,0.11 1.21,1.13 -0.45,0.72 -1.28,0.75 -1.7,0.07 z m 22.22,-0.64 -2.76,-0.01 v -4.37 -4.37 h 4.61 4.61 l 0.19,4.72 0.19,4.72 -2.04,-0.34 c -1.12,-0.19 -3.28,-0.34 -4.8,-0.35 z m 26.18,-2.14 c 0.4,-0.16 1.05,-0.16 1.45,0 0.4,0.16 0.07,0.29 -0.73,0.29 -0.8,0 -1.13,-0.13 -0.73,-0.29 z M 48.57,22.83 c -0.32,-0.11 0.51,-0.22 1.85,-0.24 1.34,-0.03 3.06,-0.29 3.83,-0.58 1.03,-0.39 1.4,-0.33 1.4,0.24 0,0.44 -0.37,0.63 -0.87,0.43 -0.52,-0.2 -0.72,-0.09 -0.5,0.27 0.34,0.55 -4,0.46 -5.71,-0.12 z m -5.19,-1.84 c -0.39,-1.02 1.41,-0.14 2.57,1.26 0.7,0.85 0.63,0.87 -0.74,0.24 -0.84,-0.38 -1.66,-1.06 -1.83,-1.5 z m 13.05,1.33 c 0,-0.12 0.46,-0.58 1.02,-1.02 0.92,-0.72 0.94,-0.7 0.22,0.22 -0.76,0.97 -1.24,1.28 -1.24,0.8 z m 30.26,-3.78 c 0,-0.79 4.44,-1.31 7.61,-0.89 4.62,0.61 3.29,1.4 -2.37,1.4 -2.88,0 -5.24,-0.23 -5.24,-0.51 z m 1.22,-1.98 -1.98,-0.13 1.6,-1.89 c 1.47,-1.75 12.55,-3.15 12.55,-1.58 0,0.17 -0.35,1.15 -0.78,2.19 l -0.78,1.88 -4.31,-0.16 c -2.37,-0.09 -5.2,-0.22 -6.29,-0.29 z M 33.59,16.33 c 0.4,-0.16 1.05,-0.16 1.45,0 0.4,0.16 0.07,0.29 -0.73,0.29 -0.8,0 -1.13,-0.13 -0.73,-0.29 z m -6.7,-0.01 c 0.56,-0.15 1.6,-0.15 2.33,-0.01 0.72,0.14 0.27,0.26 -1.01,0.27 -1.28,0.01 -1.87,-0.11 -1.32,-0.25 z m -5.36,-0.16 c -0.47,-0.3 -0.73,-0.67 -0.58,-0.82 0.15,-0.15 0.78,0.1 1.4,0.55 1.24,0.91 0.55,1.13 -0.82,0.27 z M 38.02,14.1 c -0.18,-0.48 -0.71,-0.87 -1.16,-0.87 -0.46,0 -0.98,0.39 -1.16,0.87 -1.19,3.12 -2.54,0.8 -2.54,-4.37 0,-7.92 -2.19,-8.05 -2.45,-0.15 l -0.17,5.1 -1.99,0.19 c -1.35,0.13 -2.15,-0.1 -2.5,-0.73 -0.67,-1.2 -1.98,-1.18 -2.44,0.04 -0.97,2.53 -2.67,-0.92 -2.67,-5.41 0,-5.14 -2.08,-6.73 -2.44,-1.86 L 18.32,9.33 15.86,6.18 13.41,3.02 14.99,2.65 C 16.47,2.31 16.44,2.28 14.56,2.22 13.1,2.17 12.73,1.97 13.2,1.5 c 0.38,-0.39 1.77,-0.52 3.46,-0.34 1.55,0.17 5.57,0.59 8.93,0.93 3.36,0.34 6.63,0.76 7.27,0.93 1.26,0.33 9.63,10.8 9.21,11.51 -0.48,0.81 -3.71,0.46 -4.05,-0.44 z" style="fill:#000000;stroke-width:0.456746" /></g></g></svg>
		</div>

		<div class="container table-responsive d-none" id="summary-results" style="max-width:376px">
		<table id="summary-results-table" class="table table-sm">
			<tr><th></th><th id="results-header">Dice</th></tr>
			<tr><td>Ones</td>  <td id="tot1">?</td></tr>
			<tr><td>Twos</td>  <td id="tot2">?</td></tr>
			<tr><td>Threes</td><td id="tot3">?</td></tr>
			<tr><td>Fours</td> <td id="tot4">?</td></tr>
			<tr><td>Fives</td> <td id="tot5">?</td></tr>
			<tr><td>Sixes</td> <td id="tot6">?</td></tr>
		</table>
		</div>
	<div class="container d-none" id="intro">
		<div class="row justify-content-center">
			<div class="col">
				<h1 class="display-2 mb-3">Fibbing Dice</h1>
				<p class="lead mb-4">Welcome to the Fibbing Dice game. This is an implementation
				of the "Dudo" dice game, that can be played in a group over a
				video/audio call.</p>
				<p class="lead"> If you would like to start a new game, there
				is a link to a randomly generated room below. Click the
				clipboard icon to copy the link for pasting to your
				friends.</p>
				<p class="lead">If you have been given a room link, follow that
				directly to join the room. Note that you can't join a game that
				is already in progress.</p>
				<p class="lead">Need help on a rule, have a suggestion, or just
				want to chat? Join the
				<a href="https://t.me/joinchat/FVY7AB0U12AyJEBnTeUUfg">Telegram channel</a></p>
			</div>
			<div class="col-3 mx-auto d-none d-lg-block">
				<img src="img/dice-big.png" alt="A picture of a big dice" class="img-fluid mt-5"/>
			</div>
		</div>

		<div class="row justify-content-center">
			<p><a id="room-link" href="" class="h2">Join new room</a></p>
		</div>
		<div class="row justify-content-center">
			<p class="h3">Click to copy link: <img id="copyclip" src="img/clipboard.svg" width="40" alt="Click to copy room link" onclick="copyURL();"></p>
			<img src="img/clipboard-tick.svg" width="40" class="d-none">
		</div>
		<hr/>
	</div>
	<div class="container" id="rules">
		<div class="row">
			<div class="col">
				<h2 class="panel-title" data-toggle="collapse" data-target="#fold-how-to">How to play</h2>
				<div id="fold-how-to" class="collapse multi-collapse">
					<p>As with many games, explaining the rules can seem pretty
					complicated. This isn't a difficult game though, so either
					read the below or pick it up as you go along, assuming you're
					playing with experienced players.</p>

					<p>Every player starts with five dice. The aim of the game is
					to be the last player with any dice. The game consists of a
					number of rounds where players can only see their own dice, and
					take turns to make calls predicting what dice are present.</p>

					<p>The full instructions begin below, but if you can also see an <a href="#example">example game</a>.</p>

					<h2>Starting the game</h2>
					<p>When you join a room that has not got a game playing, you
					will see all of the current players. Your player has a blue
					border as shown. The arrow indicates the direction of play.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Your name here ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div><div class="dice diceU"></div>
								<div class="dice diceU"></div><div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
					</div>
					<p>The host (indicated by the lightning bolt) should wait until
					all players are present, then press <button type="button"
					class="btn-sm btn-success m-1">Start Game</button>. The host
					also has the ability to change game settings before the game starts
					- see the cog, or to remove players at any time by clicking on
					them.</p>

					<h2>The first round</h2>
					<p>All players should click the
					<button type="button" class="btn-sm btn-success m-1">Roll</button>
					to roll a single dice. The player with the highest value
					becomes the first player to make a call. If there is a draw,
					keep rolling until there is a winner. The starter for each
					round is highlighted in green. Once the starter is decided,
					click <button type="button" class="btn-sm btn-success m-1">Roll</button>
					again to receive your dice.</p>
					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Starter ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div><div class="dice dice3"></div>
								<div class="dice dice3"></div><div class="dice dice4"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
					</div>
					<p>The call (which is made through the video/audio call) should
					be of the form "four fives", which means "I predict that there
					are at least four dice on the table that have five spots
					showing". The next player (indicated by the arrows) has to
					either make a larger call, or call Dudo ("I doubt").</p>
					<p>For the first call, it is not allowed to start with a dice
					value of one, because ones are special in most cases (explained
					below). This means the lowest value starting call is "one
					two".</p>
					<p>The player above may wish to consider a call of "threes", or
					they may decide to bluff about what dice they have.</p>

					<h2>Increasing the call</h2>
					<p>To make a larger call, the next player has to either
					increase the quantity of dice to increase the dice value, or
					even both. If you increase the quantity of dice then it is
					allowed to decrease the dice value. By making a larger call,
					the player accepts the call of the previous player, and play
					moves on to the next player who then either raises the call, or
					calls Dudo.</p>
					<p>The diagram below shows some example possible calls,
					assuming a first call of "five fours". The first option "five
					fives" increases the dice value only. The second example, "six
					fours" increases the dice quantity but leaves the dice value
					unchanged. The third example, "six twos", increases the dice
					quantity and takes the opportunity to reduce the dice value. It
					is perfectly acceptable to make bigger jumps, so a call of
					"eight sixes" in this case may be bold, but is allowed.</p>
					<p>The remaining two options are explained in the sections
					below.</p>
					<div class="row justify-content-center">
					<img src="img/tfdg-call1.svg" class="m-3"/>
					</div>

					<h2>Ones are wildcards</h2>
					<p>For most of the game, the dice value of one can be used as a
					wildcard value which matches with all other dice values. This
					means that a call of "five fours" actually means all dice
					values that are either four or one. With 25 dice, you would
					expect there to be approximately eight of each value from two
					to six. When making a new call, it is possible to change from
					using the regular dice values of two to six, to calling "ones"
					instead. This is shown in the fourth option in the diagram
					above. When a call with ones is made, the quantity of dice
					called must be halved and rounded up if necessary. So a call of
					"four fives" could be followed by a call of "two ones", or a
					call of "five sixes" could be followed by a call of "three
					ones".</p>
					<p>When a call of ones is made, it is only the dice with
					ones showing that count.</p>
					<p>It is also possible to respond to a call of "ones" by
					changing back to a call of dice values two to six. To do this,
					the quantity of dice called must be doubled, plus one.
					So a call of "two ones" could be followed by a call
					of "five threes", but not "four threes". A call of "six ones"
					could be followed by a call of "thirteen twos".</p>
					<p>The player starting a round is not allowed to have their
					first call be "ones".</p>
					<div class="row justify-content-center">
					<img src="img/tfdg-call2.svg" class="m-3"/>
					</div>

					<h2>Calling Dudo</h2>
					<p>When the player that is due to make the next call does not
					believe the previous players call, they should say Dudo, and
					click on the
					<button type="button" class="btn-sm btn-primary m-1">Dudo</button>
					button. This will result in all dice being shown player by player,
					starting with the player that called Dudo. Once
					all dice are shown, the relevant dice values (including ones or
					not, depending on the call) should be counted up to see whether
					the call was correct. If the call is correct - there were at
					least as many dice with the called dice value - then the player
					who called Dudo lost. If there were not enough dice, the
					playing making the call lost. After determining which player
					lost, they should press the
					<button type="button" class="btn-sm btn-danger m-1">Loser</button>
					button. The losing player has a dice taken away from them</p>
					<p>If you press the Loser button when you didn't mean to, don't
					worry, the Loser button transforms into an
					<button type="button" class="btn-sm btn-danger m-1">Undo</button>
					which you can use to go back and let the other player press the
					loser button.

					<h2>The next round</h2>
					<p>The player who lost their dice starts the next round, unless
					they lost their final dice, in which case the player after them
					starts. Each player clicks "Roll" to get their new dice.</p>

					<h2>Palifico</h2>
					<p>When a player loses their fourth dice, i.e. they have a
					single dice left for the first time, it is a special round called
					Palifico. In this round, ones do not count as wild, and the
					starting player can start by calling ones if they wish. After
					the first call, the dice value cannot change. So if the first
					player calls "one one", the second player could call "two
					ones", but not "one two". The round then continues as
					normal.</p>

					<p>A player who is "ex-Palifico", i.e. lost their fourth dice
					but has survived to later rounds, has a special ability in any
					later Palifico rounds they take part in. An ex-Palifico player
					can increase the dice value, but without decreasing the dice
					quantity. So if the call is "one one", an ex-Palifico player
					may call "one two". But if the call was "one six", then the
					ex-Palifico player has no choice but to call "two sixes", or
					call Dudo, because they are not allowed to reduce the dice
					value.</p>

					<p>When there are only two players remaining Palifico rounds do
					not apply.</p>

					<h2>Calza</h2>
					<p>If at some point in a round, you decide that the call that
					has just been made is exactly correct, and you are neither the
					person making the call nor the person who has to make the next
					call, then you can say "Calza" and click the
					<button type="button" class="btn-sm btn-warning m-1">Calza</button>
					button.  At this point, the dice are shown and counted up as
					normal. If the call was exactly right, i.e. for a call of "five
					fives" there must be exactly five fives, including wildcards,
					then you won the call and should click the
					<button type="button" class="btn-sm btn-warning m-1">Winner</button> button.
					You will win a dice back, up to a maximum of five dice. If there were six
					fives, then you lost, should click the
					<button type="button" class="btn-sm btn-danger m-1">Loser</button>
					button, and forfeit a dice.</p>
					<p>Calling Calza on a Palifico round is not allowed, nor if
					there are only two players in a round.</p>

					<h2>Winning the game</h2>
					<p>If you are the last player to have any dice remaining,
					congratulations you won!</p>

					<h2>Leaving the game early</h2>
					<p>If you need to leave the game before it is complete, use the
					menu button top right to access the
					<button type="button" class="btn-sm btn-danger m-1">Leave</button>
					button, which is only available at the beginning of a round.
					You will be asked to confirm your decision. When you leave the
					game your player and dice will be removed and play can
					continue as before. It is not possible to rejoin a game after
					leaving.</p>
					<p>If you are in a game that has not yet started, simply closing the page is enough to leave the game.</p>
				</div>

				<h2 id="example" class="panel-title" data-toggle="collapse" data-target="#fold-example">Example game</h2>
				<div id="fold-example" class="collapse multi-collapse">
					<p>This section shows a full example game between three
					players. For simplicity, each player only has three dice to
					start with. The game plays exactly the same with the normal
					five dice. We are playing as the player Roger.</p>

					<h3>Roll to start</h3>
					<p>The first rolls are to find the starter. Everybody rolls... and Alice wins.</p>
					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice4"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
					</div>

					<h3>Round one</h3>
					<p>Everybody rolls again to receive their first game dice.
					There are a total of 9 dice, each with 6 sides. That means each
					number will appear on average 9/6 = 1.5 times total. On normal
					rounds, dice with a value of 1 count as a wildcard, so
					including them in our count means each number 2-5 will appear
					on average 3 times total.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice3"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
					</div>
					<p>Alice makes the first call: <strong>two fives</strong>.</p>
					<p>Roger's hand already has two fives, the one and the five, so
					he cannot call Alice a liar. There are two obvious choices: go
					to three fives (which is still a plausible call), or go to one
					one. When moving from a dice value of 2-5 to a value of 1, the
					quantity of dice always has to halve, rounding up if necessary.
					Since Alice called fives, that seems a safer bet: <strong>three
					fives</strong></p>
					<p>Bob makes his call: <strong>three sixes</strong>.</p>
					<p>Alice calls <strong>Dudo</strong> on Bob's call, and so all of the dice are shown:</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice6"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
								<div class="dice dice3"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice3"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
					</div>
					<p>Bob's call is correct - two sixes and a one for a total of three sixes. Alice loses a dice.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice6"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"><img src="img/diceX.svg" width="20" height="20"></div>
								<div class="dice dice3"></div></td>
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice3"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
					</div>

					<h3>Round two</h3>
					<p>Alice lost the previous round, so she makes the first call again.</p>
					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
								<div class="dice dice3"></div>
								<div class="dice dice4"></div>
							</div>
						</div>
					</div>
					<p>Alice calls <strong>two sixes</strong>.</p>
					<p>Roger's choice is three of something, or one one. Given that Alice called sixes, nothing we have points us to a call of three, so: <strong>one one</strong>
					<p>Bob calls <strong>three threes</strong> (moving from ones back to two-six means double the quantity, plus one)</p>
					<p>Alice calls <strong>four threes</strong>.</p>
					<p>There are eight dice remaining, four of anything is daft so Roger calls <strong>Dudo</strong>.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice2"></div>
								<div class="dice dice3"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
								<div class="dice dice3"></div>
								<div class="dice dice4"></div>
							</div>
						</div>
					</div>

					<p>Unbelievably, Alice's call was correct. Roger loses a dice.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice2"></div>
								<div class="dice dice3"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div></td>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"><img src="img/diceX.svg" width="20" height="20"></div>
								<div class="dice dice3"></div>
								<div class="dice dice4"></div>
							</div>
						</div>
					</div>

					<h3>Round three</h3>
					<p>Roger lost, so he starts the next round.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice1"></div>
							</div>
						</div>
					</div>

					<p>Two ones is an excellent hand, but in a normal round
					starting on ones is not allowed, so a different call is needed.
					The aim is always to make a call low enough that the next
					person accept your call but high enough that you don't have to
					make another call. This isn't always possible... Starting with
					sixes means that Bob will have to increase the quantity, so:
					<strong>three sixes</strong>.</p>

					<p>Bob calls <strong>two ones</strong>.</p>
					<p>Alice calls <strong>Dudo</strong>...</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice3"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
								<div class="dice dice4"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice1"></div>
							</div>
						</div>
					</div>

					<p>...and loses a dice.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice3"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"><img src="img/diceX.svg" width="20" height="20"></div>
								<div class="dice dice4"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice1"></div>
							</div>
						</div>
					</div>

					<h3>Round four</h3>
					<p>Alice has lost her last but one dice, which makes this a palifico round.</p>

					<div class="alert alert-info text-center" role="alert">Palifico round!</div>
					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice2"></div>
								</div>
						</div>
					</div>
					<p>Alice calls <strong>one one</strong>. Ones are not wildcards on a Palifico round, and starting on ones is allowed.</p>
					<p>On a Palifico round a normal player can't change the dice value, so Roger has no choice but to call <strong>two ones</strong>.</p>
					<p>Bob calls <strong>Dudo</strong>.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice3"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice2"></div>
							</div>
						</div>
					</div>

					<p>Roger loses a dice.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice3"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"><img src="img/diceX.svg" width="20" height="20"></div>
								<div class="dice dice2"></div>
							</div>
						</div>
					</div>

					<h3>Round five</h3>
					<p>Roger has lost his last but one dice, which makes this a palifico round.</p>

					<div class="alert alert-info text-center" role="alert">Palifico round!</div>
					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"></div>
								</div>
						</div>
					</div>
					<p>Roger calls <strong>one five</strong>. It's a good idea not to lie on Palifico rounds.</p>
					<p>Bob calls <strong>two fives</strong>.</p>
					<p>Alice calls <strong>two sixes</strong>. Alice is ex-Palifico, so can change the dice value upwards only (she couldn't have called three fours, for example).</p>
					<p>Roger calls <strong>three sixes</strong>.</p>
					<p>Bob calls <strong>Dudo</strong>.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"></div>
								<div class="dice dice6"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"></div>
							</div>
						</div>
					</div>

					<p>Bob loses a dice.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"><img src="img/diceX.svg" width="20" height="20"></div>
								<div class="dice dice6"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"></div>
							</div>
						</div>
					</div>


					<h3>Round six</h3>
					<p>This is a normal round again. Ones are wild, and starting on a one is not allowed.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"></div>
								</div>
						</div>
					</div>
					<p>Bob calls <strong>one four</strong>.</p>
					<p>Alice calls <strong>one five</strong>.</p>
					<p>Roger calls <strong>one six</strong>.</p>
					<p>Bob calls <strong>one one</strong>.</p>
					<p>Roger calls <strong>Calza</strong>. This is a prediction that the call is <strong>exactly</strong> right. The person making the call, and the person receiving the call are not allowed to call Calza (so Calza is not allowed for two players).</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice4"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice6"></div>
							</div>
						</div>
					</div>

					<p>Roger is correct, so wins a dice.</p>

					<h3>Round seven</h3>
					<p>Roger won, so he is the starter.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice4"></div>
								<div class="dice dice6"></div>
								</div>
						</div>
					</div>
					<p>Roger calls <strong>one four</strong>.</p>
					<p>Bob calls <strong>three fours</strong>.</p>
					<p>Alice calls <strong>two ones</strong>.</p>
					<p>Roger calls <strong>Dudo</strong>.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice4"></div>
								<div class="dice dice4"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice4"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
					</div>

					<p>Alice loses a dice, and is out of the game.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice4"></div>
								<div class="dice dice4"></div>
								<div class="dice dice5"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Alice ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"><img src="img/diceX.svg" width="20" height="20"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice4"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
					</div>

					<h3>Round eight</h3>

					<p>Roger is the next player after Alice, so he starts the next round.</p>
					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice6"></div>
								</div>
						</div>
					</div>
					<p>Roger calls <strong>one six</strong>.</p>
					<p>Bob calls <strong>two sixes</strong>.</p>
					<p>Roger calls <strong>three sixes</strong>.</p>
					<p>Bob calls <strong>Dudo</strong>.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice6"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
					</div>

					<p>Bob loses a dice.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"><img src="img/diceX.svg" width="20" height="20"></div>
								<div class="dice dice6"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice3"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
					</div>

					<h3>Round nine</h3>

					<p>Bob lost, so starts the round.</p>
					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice2"></div>
								</div>
						</div>
					</div>
					<p>Bob calls <strong>one three</strong>.</p>
					<p>Roger calls <strong>one one</strong>.</p>
					<p>Bob calls <strong>Dudo</strong>.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice2"></div>
							</div>
						</div>
					</div>

					<p>Bob loses a dice.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"><img src="img/diceX.svg" width="20" height="20"></div>
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice1"></div>
								<div class="dice dice2"></div>
							</div>
						</div>
					</div>

					<h3>Round ten</h3>

					<p>Bob has lost his last but one dice, but there are only two players so this is not a Palifico round.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
								<div class="dice dice4"></div>
								</div>
						</div>
					</div>
					<p>Bob calls <strong>one six</strong>.</p>
					<p>Roger calls <strong>one one</strong>.</p>
					<p>Bob calls <strong>Dudo</strong>.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"></div>
								<div class="dice dice4"></div>
							</div>
						</div>
					</div>

					<p>Roger loses a dice.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice6"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice2"><img src="img/diceX.svg" width="20" height="20"></div>
								<div class="dice dice4"></div>
							</div>
						</div>
					</div>

					<h3>Round eleven</h3>

					<p>Roger lost, so starts the round. One dice each, this is a normal round and the most stressful round of the game.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1">
							<div class="card-header" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
								<div class="dice diceU"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-info" style="border-width:2px">
							<div class="card-header bg-success text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"></div>
								</div>
						</div>
					</div>
					<p>Roger calls <strong>one five</strong>.</p>
					<p>Bob calls <strong>one one</strong>.</p>
					<p>Roger calls <strong>Dudo</strong>.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-danger">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Bob ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice4"></div>
							</div>
						</div>
						<div class="card text-center m-1 border-danger" style="border-width:2px">
							<div class="card-header bg-danger text-white" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice dice5"></div>
							</div>
						</div>
					</div>

					<p>Bob loses a dice, and Roger wins the game.</p>

					<div class="row justify-content-center">
						<div class="card text-center m-1 border-warning" style="border-width:2px">
							<div class="card-header bg-warning" style="padding:0.5rem 1.25rem">Roger ⇨</div>
							<div class="card-body" style="padding:0.5rem">
								<div class="dice star"></div>
							</div>
						</div>
					</div>

					<p>Just a note - this example was meant to show certain situations that arise in the game: don't take it as a strategy guide.</p>
				</div>

				<h2 class="panel-title" data-toggle="collapse" data-target="#fold-user">User preferences</h2>
				<div id="fold-user" class="collapse multi-collapse">
					<p>There is a user preference for controlling sound effects,
					available in the drop down menu accessible through the cog icon.</p>
				</div>

				<h2 class="panel-title" data-toggle="collapse" data-target="#fold-options">Game options</h2>
				<div id="fold-options" class="collapse multi-collapse">
					<p>Before the game starts, it is possible to change some
					options. The host player, normally the first player to create
					the game and indicated by a lightning icon, is the only player
					allowed to change the game options.</p>
					<ul>
						<li>Allow Calza - is the Calza call enabled (defaults to on)</li>
						<li>Losers see dice - if set on, then players who have lost
							will be able to see the dice for all players as the round
							is being player, not just after Dudo/Calza has been called.
							Defaults to on.</li>
						<li>Show results table - if set to on, a summary of all
							results will be displayed at the end of the round to
							make counting up easier. Setting this on gives a big
							advantage to all players because they can very easily see
							what calls were reasonable in the previous round. Defaults
							to on.</li>
						<li>Maximum dice count - choose how many dice to start with
							(and the maximum count, if playing with Calza). Can
							range from 3-20.</li>
						<li>Maximum dice value - choose how many sides the dice
							should have. Can range from 3-9.</li>
					</ul>
				</div>

				<h2 class="panel-title" data-toggle="collapse" data-target="#fold-removing">Removing players</h2>
				<div id="fold-removing" class="collapse multi-collapse">
					<p>The host player has the ability to remove players from a
					game at the end of a round. To do this, click on the player
					name and then confirm your decision.</p>
				</div>

				<h2 class="panel-title" data-toggle="collapse" data-target="#fold-privacy">Privacy</h2>
				<div id="fold-privacy" class="collapse multi-collapse">
					<p>Review cookie and data storage on the <a href="privacy.html">Privacy</a> page.</p>
				</div>
			</div>
		</div>
	</div>
	</body>
</html>
